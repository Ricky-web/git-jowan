<article>
  <p id="notice"><%= notice %></p>
  <%= paginate @posts %>
  <% @posts.each do |post| %>
    <div class="article-container">
        <% if current_user.already_watched?(post) %>
            <a class="article-link" href="/posts/<%= post.id %>"></a>
        <% else %>
            <%= link_to "", post_views_path(post), method: :post, class: "article-link" %>
        <% end %>
        <div class="currency-pair">
            <h3><%= post.currency_pair %></h3>
            <%= image_tag "#{post.currency_pair[0, 3]}.png", class: "currency", alt: "#{post.currency_pair[0, 3]}" %>
            <%= image_tag "#{post.currency_pair[3, 6]}.png", class: "margin-currency", alt: "#{post.currency_pair[3, 6]}" %>
        </div>
        <div class="article-title">
            <% if current_user.already_watched?(post) %>
                <h2><span style="border-bottom: solid 1px black;"><%= post.title %></span></h2>
            <% else %>
                <h2><span style="border-bottom: solid 1px black;"><%= post.title %></span></h2>
            <% end %>
            <time datetime="<%= DateTime.parse(post.updated_at.to_s) %>"><span>üñä</span><%= post.updated_at.strftime("%a, %d %b %Y %X %Z") %></time>
        </div>
        <ul class="evaluation-box">
            <% if current_user.already_liked?(post) %>
                <li style="background: #6495ED;"><%= link_to "üëç#{post.likes.count}", "/posts/#{post.id}/likes/#{post.likes.find_by(user_id: current_user.id).id}", method: :delete %></li>
                <% if post.comments.exists?(user_id: current_user.id) %>
                    <li style="background: #6495ED;"><%= link_to "üí¨#{post.comments.count}", post_path(post), method: :get %></li>
                <% else %>
                  <li><%= link_to "üí¨#{post.comments.count}", post_path(post), method: :get %></li>
                <% end %>
                <% if current_user.already_watched?(post) %>
                    <li style="background: #6495ED;">üëÅ<%= post.views.count %></li>
                <% else %>
                  <li>üëÅ<%= post.views.count %></li>
                <% end %>
            <% else %>
                <li><%= link_to "üëç#{post.likes.count}", "/posts/#{post.id}/likes", method: :post %></li>
                <% if post.comments.exists?(user_id: current_user.id) %>
                    <li style="background: #6495ED;"><%= link_to "üí¨#{post.comments.count}", post_path(post), method: :get %></li>
                <% else %>
                  <li><%= link_to "üí¨#{post.comments.count}", post_path(post), method: :get %></li>
                <% end %>
                <% if current_user.already_watched?(post) %>
                    <li style="background: #6495ED;">üëÅ<%= post.views.count %></li>
                <% else %>
                  <li>üëÅ<%= post.views.count %></li>
                <% end %>
            <% end %>
        </ul>
        <div class="poster-info">
            <% if post.user.image.attached? %>
                <%= image_tag post.user.image, alt: "#{post.user.nickname}", class: "poster-image" %>
            <% else %>
                <%= image_tag "default.png", alt: "#{post.user.nickname}", class: "poster-image" %>
            <% end %>
            <small>Poster: <%= link_to "#{post.user.nickname}", user_path(post.user.id), method: :get %></small>
        </div>
    </div>
  <% end %>
  <%= paginate @posts %>
</article>